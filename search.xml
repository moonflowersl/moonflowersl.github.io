<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>2020ctf新生赛wp</title>
    <url>/2020/12/12/2020sdu%E6%96%B0%E7%94%9F%E8%B5%9Bwp/</url>
    <content><![CDATA[<blockquote>
<ul>
<li><h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><blockquote>
<ul>
<li><h4 id="签到"><a href="#签到" class="headerlink" title="签到"></a>签到</h4></li>
</ul>
<p>一串字符，没有什么奇怪的符号，base家族挨个试一下，发现base16能解码出flag（只有前几个大写字母，大概率是base16）。</p>
<a id="more"></a>

<ul>
<li><h4 id="不说人话？"><a href="#不说人话？" class="headerlink" title="不说人话？"></a>不说人话？</h4></li>
</ul>
<p>下载，解压，得到一个不知道是啥的文件，根据Misc解题法则，管他是什么先拖进16进制编辑器里look look，然后就发现一个五角星</p>
<p><img src="https://github.com/moonflowersl/moonflowersl.github.io/blob/main/images/%E4%B8%8D%E8%AF%B4%E4%BA%BA%E8%AF%9D1.png?raw=true"></p>
<p>（然而好像并没有）什么卵用……</p>
<p>再观察一下发现出现的字符只有’&gt;’, ‘&lt;’, ‘+’, ‘-‘, ‘.’几种，那这大概就是Brainfuck或Ook！了（**brainfuck**又被称为**brainf**k**或者**BF**，**brainfuck**语言用**&gt; &lt; + - . , [ ]**八种符号来替换C语言的各种语法和命令）。</p>
<p>百度一个<a href="https://www.splitbrain.org/services/ook">在线解密网站 </a> 复制粘贴解出flag。</p>
<ul>
<li><h4 id="LSB"><a href="#LSB" class="headerlink" title="LSB"></a>LSB</h4></li>
</ul>
<p><del>BUUCTF原题</del></p>
<p>LSB 隐写术，即最低有效位（Least Significant Bit）隐写术。是一种比较简单的基于二进制的隐写方式，能将一个完整的文件隐藏进另一张图片中。图像一般都是以RGB三原色的方式存储的，存储后R（红）、G（绿）、B（蓝）三组数据按顺序规律排列，每个的取值范围为0~255，范围对应的二进制值就是00000000-11111111，LSB就是把一个文件的二进制每一位拆分修改到图片的色彩数据的二进制值最低位。</p>
<p>​                                                                                                                        ——来自百度</p>
<p>也就是说每种颜色是由8个bit存储的二进制位，我悄悄地改掉最后一位几乎是看不出来了，所以信息就被有效隐写了。</p>
<p>处理LSB隐写的最常用的工具就是Stegsolve，用它打开压缩包里的图片，操作方式：Analyse→Data Extract→选择red,blue,green中 的0（此时发现Extract Preview中的16进制文件是个png）→Save bin（后缀名为.png）。得到一个二维码，在线扫一下得到flag。</p>
</blockquote>
</li>
<li><h3 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h3><blockquote>
<ul>
<li><h4 id="Caesar"><a href="#Caesar" class="headerlink" title="Caesar"></a>Caesar</h4><p>凯撒密码显而易见了，Notifications中提供了<a href="http://ctf.ssleye.com/">CTF在线工具</a></p>
<p>多试几次，发现key=13时，明文为attack_at_nine_o ‘clock_tonight。</p>
</li>
<li><h4 id="RSA1"><a href="#RSA1" class="headerlink" title="RSA1"></a>RSA1</h4><h5 id="rsa加密过程"><a href="#rsa加密过程" class="headerlink" title="rsa加密过程"></a>rsa加密过程</h5><ol>
<li>选取两个整数 p,q</li>
<li>求出 n = p * q</li>
<li>求 n 的欧拉函数 phi(n) = (p-1) * (q-1)</li>
<li>随机去一个整数 e 作为公钥，要求 e 和 phi(n) 互素</li>
<li>求出私钥 d : ed ≡ 1 (mod phi(n)) （d是e的逆元）</li>
</ol>
<h5 id="加密算法："><a href="#加密算法：" class="headerlink" title="加密算法："></a>加密算法：</h5><p>c = pow(m,e,n)</p>
<h5 id="解密算法："><a href="#解密算法：" class="headerlink" title="解密算法："></a>解密算法：</h5><p>m =pow(c,d,n)</p>
<h6 id="关于题目："><a href="#关于题目：" class="headerlink" title="关于题目："></a>关于题目：</h6><p>题目中已经给了c,n,e了，思路也就很明显了：先把n分解成p,q（Notifications中提供了<a href="http://www.factordb.com/">大整数分解网站</a>），知道了p,q就可以求出phi(n),再用扩展欧几里得算法求出e再mod n下的逆元d，最后求出m。</p>
</li>
</ul>
<p>  脚本如下：</p>
  <figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="number">67692316911846383515666937548215377516026242122014572162117994514425606283681</span></span><br><span class="line">n = <span class="number">103461035900816914121390101299049044413950405173712170434161686539878160984549</span></span><br><span class="line">p = <span class="number">282164587459512124844245113950593348271</span></span><br><span class="line">q = <span class="number">366669102002966856876605669837014229419</span></span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">d = libnum.invmod(e, (p - <span class="number">1</span>) * (q - <span class="number">1</span>))</span><br><span class="line">m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line"></span><br><span class="line">print(libnum.n2s(m))</span><br></pre></td></tr></table></figure>

<p>  （最后要用libnum中的n2s将得到的m转化为字符串）。</p>
<ul>
<li><h4 id="RSA2"><a href="#RSA2" class="headerlink" title="RSA2"></a>RSA2</h4><p>又是rsa算法，但是打开txt发现有两个e和c，推测应该是用共模数攻击了。</p>
<h5 id="rsa的共模数攻击："><a href="#rsa的共模数攻击：" class="headerlink" title="rsa的共模数攻击："></a>rsa的共模数攻击：</h5><p>因为我们手上有一对明文和对应的公钥，那么如果有整数x, y使得：</p>
<p>e1 * x + e2 * y = 1</p>
<p>那么就可以有：</p>
<p>m (mod n) = m ^ 1 (mod n) = m ^ (e1 * x + e2 *y ) (mod n) = m ^ (e1 * x) + m ^ (e2 * y)</p>
<p>又因为：</p>
<p> c1 = m ^ e1 (mod n)     c2 = m ^ e2 (mod n)</p>
<p>所以就有：</p>
<p>m (mod n) = c1 ^ x + c2 ^ y (mod n)</p>
<p>其中x，y可由扩展欧几里得算法求出</p>
</li>
</ul>
<p>  脚本如下：</p>
  <figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">n = <span class="number">20429315528655111523073560675648813309162375303954090348572329091957960032412518712093691044501240262294304779722690063594446637140928522882936561204180425968593685714138402078212148627806816974924904301217144262198933589412344408694401386330925556100970326676200349102533012051159456051076045413561059070291766268594455676378031127514060030926838750670330939410961355756909171469945402924037610757364146531235448523106870829710488056210511070536574177473906753241807683881800419949735443822439277498329376433536971257102334607742626401589209417830185425783917209141580607207923687068496513264733739213966151881471319</span></span><br><span class="line">e1 = <span class="number">4106294671</span></span><br><span class="line">e2 = <span class="number">4103337937</span></span><br><span class="line">c1 = <span class="number">12051796366524088489284445109295502686341498426965277230069915294159131976231473789977279364263965099422235647723775278060569378071469131866368399394772898224166518089593340803913798327451963589996734323497943301819051718709807518655868569656941242449109980876397661605271517459716669684900920279597477446629607627693769738733623143693170696779851882404994923673483971528314806130892416509854017091137325195201225617407959645788145876202882024723106204183257094755002924708009138560347432552090905489132135154932987521239299578509008290614398700799670928805692609756924823628055245227290288940649158862576448537833423</span></span><br><span class="line">c2 = <span class="number">16648382384980770705624348910895797622774711113202207693584907182552301186239613809347201161450012615995859738410661452438496756353485538305614949211776668793864984429696790944750894691957799234264508530084026894611228513698963347402329109838109621609770406925700520983387811451074838470370044678634099202003480925903267508744006195455234025325060817223813858985074720872124168142943926467694676717713503559007112874381750005406371400109962943508349497151148446064846096531445037416174913915923050332242843403926133165817310272633884358263778516770288515592959832151762499526363131801945163501999337808208074381212795</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">n2s</span>(<span class="params">num</span>):</span></span><br><span class="line">    t = <span class="built_in">hex</span>(num)[<span class="number">2</span>:]</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(t) % <span class="number">2</span> == <span class="number">1</span> :</span><br><span class="line">        t = t + <span class="string">&#x27;0&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join([<span class="built_in">chr</span>(<span class="built_in">int</span>(b, <span class="number">16</span>)) <span class="keyword">for</span> b <span class="keyword">in</span> [ t[ i : i+<span class="number">2</span> ] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(t), <span class="number">2</span>)]])</span><br><span class="line"><span class="comment">#这句是网上抄的，但这句话写的是真的好</span></span><br><span class="line"></span><br><span class="line">s = gmpy2.gcdext(e1, e2)</span><br><span class="line">s1 = s[<span class="number">1</span>]</span><br><span class="line">s2 = -s[<span class="number">2</span>]</span><br><span class="line">c2 = gmpy2.invert(c2, n)</span><br><span class="line"></span><br><span class="line">m = (<span class="built_in">pow</span>(c1, s1, n) * <span class="built_in">pow</span>(c2, s2, n)) % n</span><br><span class="line">print(n2s(m))</span><br><span class="line"><span class="comment">#print(libnum.n2s(m)) libnum.n2s好像因为m太大了转不了，但我用m得到的字符串用libnum.s2n却能转回来（玄学）</span></span><br></pre></td></tr></table></figure>

<h5 id="关于大整数转字符串的原理"><a href="#关于大整数转字符串的原理" class="headerlink" title="关于大整数转字符串的原理"></a>关于大整数转字符串的原理</h5><p>  计算机存储中，一个字节8个bit，代表数值是0~255，这个数值就是ascii码中对应的字符。</p>
<p>  一个16进制表示的数刚好占4个bit，所以两个16进制位就可以有一个对应的字符。</p>
<p>  剩下的你懂的（doge）</p>
</blockquote>
</li>
</ul>
<ul>
<li><h3 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h3><blockquote>
<ul>
<li><h4 id="阴间2048"><a href="#阴间2048" class="headerlink" title="阴间2048"></a>阴间2048</h4></li>
</ul>
<p>拿到题目先玩会（说不定就有flag了呢），然而玩了几千分也没见什么异常，旁边三个连接点了点也没得到什么有用的东西（出题人总不能把flag藏在人家的GitHub项目里面吧）。</p>
<p>按照web套路，F12看源码，network刷新一下看看包</p>
<p><img src="https://github.com/moonflowersl/moonflowersl.github.io/blob/main/images/%E9%98%B4%E9%97%B42048.png?raw=true"></p>
<p>哦？发现了一个别致的小东西</p>
<p>然后打开game.js看看有没有奇怪的地方</p>
<p><img src="https://github.com/moonflowersl/moonflowersl.github.io/blob/main/images/%E9%98%B4%E9%97%B420482.png?raw=true"></p>
<p>写个游戏能搞个这玩意？？？</p>
<p>按照它说的向网页get一下，成功得到flag</p>
<p><img src="https://github.com/moonflowersl/moonflowersl.github.io/blob/main/images/%E9%98%B4%E9%97%B420483.png?raw=true"></p>
</blockquote>
</li>
</ul>
</blockquote>
<p>4个小时就搞了这点（我太菜了），web第二题最后一步死活搞不对了，web第三题打开发现是个代码审计，再看看时间，下次一定。</p>
]]></content>
  </entry>
  <entry>
    <title>Hello World</title>
    <url>/2020/12/11/hello-world/</url>
    <content><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p>
<a id="more"></a>

<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>
]]></content>
  </entry>
  <entry>
    <title>欢迎来到我的博客园</title>
    <url>/2020/12/12/%E6%AC%A2%E8%BF%8E%E6%9D%A5%E5%88%B0%E6%88%91%E7%9A%84%E5%8D%9A%E5%AE%A2%E5%9B%AD/</url>
    <content><![CDATA[<h2 id="我是谁？"><a href="#我是谁？" class="headerlink" title="我是谁？"></a>我是谁？</h2><p>普通高校的菜鸡学生，CTF未入门选手。</p>
<h2 id="搞什么？"><a href="#搞什么？" class="headerlink" title="搞什么？"></a>搞什么？</h2><p><del>被迫</del>搭博客写wp，虽然很无奈但是也挺好的吧。</p>
]]></content>
  </entry>
  <entry>
    <title>web-1 buuoj[极客大挑战 2019]PHP1</title>
    <url>/2020/12/12/Web-1%20buuoj%5B%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98%202019%5DPHP/</url>
    <content><![CDATA[<h2 id="buuoj-极客大挑战-2019-PHP1"><a href="#buuoj-极客大挑战-2019-PHP1" class="headerlink" title="buuoj[极客大挑战 2019]PHP1"></a>buuoj[极客大挑战 2019]PHP1</h2><blockquote>
<ul>
<li><h4 id="解题思路"><a href="#解题思路" class="headerlink" title="解题思路"></a>解题思路</h4></li>
<li><h4 id="解题过程"><a href="#解题过程" class="headerlink" title="解题过程"></a>解题过程</h4></li>
<li><h4 id="get的新姿势"><a href="#get的新姿势" class="headerlink" title="get的新姿势"></a>get的新姿势</h4></li>
</ul>
</blockquote>
<a id="more"></a>

<ul>
<li><h3 id="解题思路-1"><a href="#解题思路-1" class="headerlink" title="解题思路"></a>解题思路</h3></li>
</ul>
<ol>
<li><p>拿到网页，没有输入框，注入暴力算是无了？</p>
</li>
<li><p>f12瞅一下，没什么有用的东西。</p>
</li>
<li><p>提示说有备份，那就拿扫描器扫一下，发现有个<a href="http://www.zip/">www.zip</a></p>
</li>
<li><p>解压得到一个假的flag.php，但得到的index.php和class.php是有用的，根据其中的提示判定应该是个PHP反序列化漏洞，那么这要构造相应的字符串就搞定了。</p>
</li>
</ol>
<ul>
<li><h3 id="解题过程-1"><a href="#解题过程-1" class="headerlink" title="解题过程"></a>解题过程</h3><h4 id="1-dirsearch的安装和使用"><a href="#1-dirsearch的安装和使用" class="headerlink" title="1. dirsearch的安装和使用"></a>1. dirsearch的安装和使用</h4><p> <del>原来这玩意在windows下装完就能用了。</del></p>
<p> cmd切到dirsearch所在的目录，然后运行命令</p>
<p><code>py dirsearch.py -u (题目连接) -s 3</code></p>
<p>加上“-s 3“是因为默认设置扫的太频繁，然后就会：</p>
<p><img src="https://github.com/moonflowersl/moonflowersl.github.io/blob/main/images/web-1(1).png?raw=true" alt="报错"></p>
<p>虽然加个延迟会慢一些但至少能扫出来<a href="http://www.zip/">www.zip</a>.</p>
</li>
</ul>
<h4 id="2-关于网页的备份文件"><a href="#2-关于网页的备份文件" class="headerlink" title="2.关于网页的备份文件"></a>2.关于网页的备份文件</h4><p>  网站备份压缩文件泄露，是因为备份了网站源码讲其保存成zip等压缩格式。</p>
  <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#39;.rar&#39;,&#39;.zip&#39;,&#39;.tar&#39;,&#39;.tar.bz2&#39;,&#39;.sql&#39;,&#39;.7z&#39;,&#39;.bak&#39;,&#39;.txt&#39;</span><br></pre></td></tr></table></figure>

<p>  如果我们这里要进行检测和利用的话，首先要有一个字典，这个字典的精度越高，那么判断效果越好。</p>
<p>  最常见的就是<a href="http://www.zip/">www.zip</a></p>
<p>  （所以做题没有头绪时扫一下可能会有惊喜）</p>
<h4 id="3-关于PHP反序列化漏洞"><a href="#3-关于PHP反序列化漏洞" class="headerlink" title="3.关于PHP反序列化漏洞"></a>3.关于PHP反序列化漏洞</h4><p>  <strong>PHP序列化与反序列化</strong></p>
<p>  PHP通过string serialize ( mixed $value )和mixed unserialize ( string $str )两个函数实现序列化和反序列化。</p>
<p>  下面是比较典型的PHP反序列化漏洞中可能会用到的魔术方法：</p>
<p>  void __wakeup ( void )</p>
<p>  unserialize( )会检查是否存在一个_wakeup( ) 方法。如果存在，则会先调用_wakeup 方法，预先准备对象需要的资源。</p>
<p>  void __construct ([ mixed $args [, $… ]])</p>
<p>  具有构造函数的类会在每次创建新对象时先调用此方法。</p>
<p>  void __destruct ( void )</p>
<p>  析构函数会在到某个对象的所有引用都被删除或者当对象被显式销毁时执行。</p>
<p>  public string __toString ( void )</p>
<p>  __toString( ) 方法用于一个类被当成字符串时应怎样回应。例如 echo $obj;应该显示些什么。</p>
<p>  此方法必须返回一个字符串，否则将发出一条 E_RECOVERABLE_ERROR 级别的致命错误。</p>
<p>   （摘自i春秋）</p>
<p>  说人话就是PHP通过序列化和反序列化的方法将对象转化为字符串方便传输，有又因为在反序列化的过程中PHP对象会执行magic函数，因此我们可以通过构造特定的字符串控制函数，一步一步拿到flag。</p>
  <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">include &#39;flag.php&#39;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">error_reporting(0);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class Name&#123;</span><br><span class="line">    private $username &#x3D; &#39;nonono&#39;;</span><br><span class="line">    private $password &#x3D; &#39;yesyes&#39;;</span><br><span class="line"></span><br><span class="line">    public function __construct($username,$password)&#123;</span><br><span class="line">        $this-&gt;username &#x3D; $username;</span><br><span class="line">        $this-&gt;password &#x3D; $password;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function __wakeup()&#123;</span><br><span class="line">        $this-&gt;username &#x3D; &#39;guest&#39;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function __destruct()&#123;</span><br><span class="line">        if ($this-&gt;password !&#x3D; 100) &#123;</span><br><span class="line">            echo &quot;&lt;&#x2F;br&gt;NO!!!hacker!!!&lt;&#x2F;br&gt;&quot;;</span><br><span class="line">            echo &quot;You name is: &quot;;</span><br><span class="line">            echo $this-&gt;username;echo &quot;&lt;&#x2F;br&gt;&quot;;</span><br><span class="line">            echo &quot;You password is: &quot;;</span><br><span class="line">            echo $this-&gt;password;echo &quot;&lt;&#x2F;br&gt;&quot;;</span><br><span class="line">            die();</span><br><span class="line">        &#125;</span><br><span class="line">        if ($this-&gt;username &#x3D;&#x3D;&#x3D; &#39;admin&#39;) &#123;</span><br><span class="line">            global $flag;</span><br><span class="line">            echo $flag;</span><br><span class="line">        &#125;else&#123;</span><br><span class="line">            echo &quot;&lt;&#x2F;br&gt;hello my friend~~&lt;&#x2F;br&gt;sorry i can&#39;t give you the flag!&quot;;</span><br><span class="line">            die();</span><br><span class="line"></span><br><span class="line">            </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>



<p>看来只需要构造一个Name对象，使其password=100,username=admin，就能触发显示flag的条件了。</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Name</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$password</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$username</span>;</span><br><span class="line">    </span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$username</span>,<span class="variable">$password</span></span>)</span>&#123;</span><br><span class="line">		<span class="keyword">$this</span>-&gt;username = <span class="variable">$username</span>;</span><br><span class="line">		<span class="keyword">$this</span>-&gt;password = <span class="variable">$password</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">&amp;a = <span class="keyword">new</span> Name(<span class="number">100</span>,admin);</span><br><span class="line"><span class="keyword">echo</span> serialize(<span class="variable">$a</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>输出构造好的字符串</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">O:4:&quot;Name&quot;:2:&#123;s:14:&quot;Namepassword&quot;;s:5:&quot;admin&quot;;s:14:&quot;Nameusername&quot;;i:100;&#125;</span><br></pre></td></tr></table></figure>

<p>然鹅这还不够</p>
<h5 id="问题1-private的处理"><a href="#问题1-private的处理" class="headerlink" title="问题1.private的处理"></a>问题1.private的处理</h5><p>对public，protected，private三种声明方式没有区分，实际上每种都有不同格式要求</p>
<p>public:         O:4:”Name”:2:{s:8:”username”;s:5:”admin”;s:8:”password”;i:100;}</p>
<p>protected:  O:4:”Name”:2:{s:11:” * username”;s:5:”admin”;s:11:” * password”;i:100;}</p>
<p>private:       O:4:”Name”:2:{s:14:” Name username”;s:5:”admin”;s:14:” Name password”;i:100;}</p>
<h5 id="问题2-wakeup函数的绕过"><a href="#问题2-wakeup函数的绕过" class="headerlink" title="问题2.__wakeup函数的绕过"></a>问题2.__wakeup函数的绕过</h5><p>PHP中的小规则，如果传入字符串中的对象应有的变量个数比实际的多（在字符串的表示中），那程序会自动跳过wakeup的执行。</p>
<p>因此需要把串改为</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">O:4:&quot;Name&quot;:3:&#123;s:14:&quot; Name username&quot;;s:5:&quot;admin&quot;;s:14:&quot; Name password&quot;;i:100;&#125;</span><br></pre></td></tr></table></figure>

<p>最后以get方式提交一下，获得flag。</p>
<ul>
<li><h3 id="get的新姿势-1"><a href="#get的新姿势-1" class="headerlink" title="get的新姿势"></a>get的新姿势</h3><ol>
<li><p>dirsearch的安装和使用</p>
</li>
<li><p>PHP反序列化漏洞的利用</p>
</li>
<li><p>一丢丢的PHP编程（我连PHP都不会 ）</p>
</li>
</ol>
</li>
</ul>
]]></content>
  </entry>
  <entry>
    <title>web-2 buuoj[极客大挑战 2019]Http1</title>
    <url>/2020/12/12/web-2/</url>
    <content><![CDATA[<h2 id="buuoj-极客大挑战-2019-Http1"><a href="#buuoj-极客大挑战-2019-Http1" class="headerlink" title="buuoj[极客大挑战 2019]Http1"></a>buuoj[极客大挑战 2019]Http1</h2><blockquote>
<ul>
<li><h4 id="解题思路"><a href="#解题思路" class="headerlink" title="解题思路"></a>解题思路</h4></li>
<li><h4 id="解题过程"><a href="#解题过程" class="headerlink" title="解题过程"></a>解题过程</h4></li>
<li><h4 id="get的新姿势"><a href="#get的新姿势" class="headerlink" title="get的新姿势"></a>get的新姿势</h4></li>
</ul>
</blockquote>
<a id="more"></a>

<ul>
<li><h3 id="解题思路-1"><a href="#解题思路-1" class="headerlink" title="解题思路"></a>解题思路</h3></li>
</ul>
<ol>
<li><p>是个很正经的网页，f12搜一下源码，没什么明显的提示信息。</p>
</li>
<li><p>dirsearch扫一扫也没什么有用的东西。</p>
</li>
<li><p>题目提示HTTP，burpsuite截个包，发现相应里提示Secret.php。</p>
</li>
<li><p>根据网页提示修改HTTP请求头访问，最后得到flag。</p>
</li>
<li><h3 id="解题过程-1"><a href="#解题过程-1" class="headerlink" title="解题过程"></a>解题过程</h3><p>1.没什么思路就截个包，然后好东西就来了。</p>
<p><img src="https://github.com/moonflowersl/moonflowersl.github.io/blob/main/images/web-2.1.png?raw=true"></p>
<p>2.然后就查一下Secret.php目录，顺便抓个包。</p>
<p><img src="https://github.com/moonflowersl/moonflowersl.github.io/blob/main/images/web-2.8.png?raw=true"></p>
</li>
</ol>
<p>   3.要修改它的来源（这个描述可能不确切），可以通过伪造referer头来实现。</p>
<p>   <img src="https://github.com/moonflowersl/moonflowersl.github.io/blob/main/images/web-2.2.png?raw=true"></p>
<p>   然后send过去看一下respond</p>
<p>   <img src="https://github.com/moonflowersl/moonflowersl.github.io/blob/main/images/web-2.3.png?raw=true"></p>
<p>   4.发起请求的浏览器的修改可以通过修改User-Agent来实现</p>
<p>   <img src="https://github.com/moonflowersl/moonflowersl.github.io/blob/main/images/web-2.4.png?raw=true"></p>
<p>   然后还没完</p>
<p>   <img src="https://github.com/moonflowersl/moonflowersl.github.io/blob/main/images/web-2.5.png?raw=true"></p>
<p>   5.要弄成本地访问，可以通过伪造XFF头来实现</p>
<p>   <img src="https://github.com/moonflowersl/moonflowersl.github.io/blob/main/images/web-2.6.png?raw=true"></p>
<p>   终于结束了。。。。。。</p>
<p>   <img src="https://github.com/moonflowersl/moonflowersl.github.io/blob/main/images/web-2.7.png?raw=true"></p>
<h4 id="完结撒花"><a href="#完结撒花" class="headerlink" title="完结撒花!!!"></a>完结撒花!!!</h4><ul>
<li><h3 id="get的新姿势-1"><a href="#get的新姿势-1" class="headerlink" title="get的新姿势"></a>get的新姿势</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">:authority: www.google.com.hk    # 请求的域名（对方的服务器地址）</span><br><span class="line">:method: GET                     # 请求方法，一般浏览器访问网站使用GET请求                     </span><br><span class="line">:path: &#x2F;?gws_rd&#x3D;ssl              # 请求路径，也就是 https:&#x2F;&#x2F;ww.google.com.hk&#x2F; 后面的内容</span><br><span class="line">:scheme: https                   # 请求的协议，这里使用https协议（使用SSL加密的http协议）</span><br><span class="line">accept: text&#x2F;html,application&#x2F;xhtml+xml,application&#x2F;xml;q&#x3D;0.9,image&#x2F;webp,image&#x2F;apng响应头,*&#x2F;*;q&#x3D;0.8,application&#x2F;signed-exchange;v&#x3D;b3;q&#x3D;0.9</span><br><span class="line"># 请求文件类型，可以吧这里的文件类型Google一下，因为篇幅太长这里就不做详细介绍了（如text&#x2F;html是文档&#x2F;HTML文档的意思）</span><br><span class="line">accept-encoding: gzip, deflate, br  # 压缩类型，支援gzip,deflate,br 压缩方式</span><br><span class="line">accept-language: zh-HK,zh;q&#x3D;0.9  # 浏览器语言，我的默认语言是 zh-hk （中国-香港）</span><br><span class="line">cache-control: no-cache          # 缓存讯息，这里是 不缓存（no-cache）</span><br><span class="line">pragma: no-cache                 # 缓存来源</span><br><span class="line">sec-fetch-dest: document         # sec-fetch-* 意为如何使用返回的参数</span><br><span class="line">sec-fetch-mode: navigate</span><br><span class="line">sec-fetch-site: same-origin</span><br><span class="line">sec-fetch-user: ?1</span><br><span class="line">upgrade-insecure-requests: 1     # 不用在意这个东西</span><br><span class="line">user-agent: Mozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;86.0.4240.183 Safari&#x2F;537.36 Edg&#x2F;86.0.622.63</span><br><span class="line"># 非常重要的浏览器UA，表明了浏览器的身份：是什么内核，运行在什么系统上</span><br></pre></td></tr></table></figure>

<p>（来自知乎-啄木鸟的面包房）</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">referer: www.baidu.com (记录从哪个网站过来的，可以用来统计流量和防盗链，如果是空就是没有限制)</span><br><span class="line">x-forwarded-for：127.0.0.0 (用来表示 HTTP 请求端真实 IP)</span><br></pre></td></tr></table></figure>

</li>
</ul>
]]></content>
  </entry>
  <entry>
    <title>web-3 buuoj [极客大挑战 2019]Upload</title>
    <url>/2020/12/14/web-3/</url>
    <content><![CDATA[<h1 id="buuoj-极客大挑战-2019-Upload"><a href="#buuoj-极客大挑战-2019-Upload" class="headerlink" title="buuoj [极客大挑战 2019]Upload"></a>buuoj [极客大挑战 2019]Upload</h1><blockquote>
<ul>
<li><h4 id="解题思路"><a href="#解题思路" class="headerlink" title="解题思路"></a>解题思路</h4></li>
<li><h4 id="解题过程"><a href="#解题过程" class="headerlink" title="解题过程"></a>解题过程</h4></li>
<li><h4 id="get的新姿势"><a href="#get的新姿势" class="headerlink" title="get的新姿势"></a>get的新姿势</h4></li>
</ul>
</blockquote>
<a id="more"></a>

<ul>
<li><h3 id="解题思路-1"><a href="#解题思路-1" class="headerlink" title="解题思路"></a>解题思路</h3><ol>
<li>显然是个文件上传漏洞，那就先传个一句话木马试试。</li>
<li>必须要求是图片类型，后面加上.png。</li>
<li>还不行，看来是在服务端的过滤了，那就改一下Content-Type头（MIME协议）。</li>
<li>过滤了php？！此处采用了phtml这个骚姿势（当然一句话木马也要改一下）。</li>
<li>还不行，似乎能根据文件内容判断。再次骚姿势，在文件前面加上个图片的文件头伪造，成功传入木马。</li>
</ol>
</li>
<li><h3 id="解题过程-1"><a href="#解题过程-1" class="headerlink" title="解题过程"></a>解题过程</h3><ol>
<li><p>先随便传一个试试吧</p>
<p><img src="https://github.com/moonflowersl/moonflowersl.github.io/blob/main/images/web-3.1.png?raw=true"></p>
</li>
<li><p>再加个png后缀名，判断是前端过滤还是服务端过滤</p>
<p><img src="https://github.com/moonflowersl/moonflowersl.github.io/blob/main/images/web-3.2.png?raw=true"></p>
<p>多半是服务端对上传文件的检查了。。。麻烦</p>
</li>
<li><p>改一下Content-Type头，用于伪造传入的文件类型</p>
<p><img src="https://github.com/moonflowersl/moonflowersl.github.io/blob/main/images/web-3.3.png?raw=true"></p>
<p>就但看php不爽？？？直接给滤了。</p>
</li>
<li><p>传php看来是不可行了，只能试试phtml了。。。</p>
<p><img src="https://github.com/moonflowersl/moonflowersl.github.io/blob/main/images/web-3.4.png?raw=true"></p>
<p>绕过了但是还不行，可能是对传入的文件内容进行了检查（离谱）。</p>
</li>
<li><p>在文件中写入图片的文件头，执行的时候会被当做无意义字符过滤掉。</p>
<p><img src="https://github.com/moonflowersl/moonflowersl.github.io/blob/main/images/web-3.5.png?raw=true"></p>
</li>
</ol>
</li>
<li><h3 id="get的新姿势-1"><a href="#get的新姿势-1" class="headerlink" title="get的新姿势"></a>get的新姿势</h3><ol>
<li><h5 id="MIME协议"><a href="#MIME协议" class="headerlink" title="MIME协议"></a>MIME协议</h5><p>最早的HTTP协议中，并没有附加的数据类型信息，所有传送的数据都被客户程序解释为超文本标记语言HTML 文档，而为了支持多媒体数据类型，HTTP协议中就使用了附加在文档之前的MIME数据类型信息来标识数据类型。</p>
<p>　　MIME意为多目Internet邮件扩展，它设计的最初目的是为了在发送电子邮件时附加多媒体数据，让邮件客户程序能根据其类型进行处理。然而当它被HTTP协议支持之后，它的意义就更为显著了。它使得HTTP传输的不仅是普通的文本，而变得丰富多彩。</p>
<p>　　每个MIME类型由两部分组成，前面是数据的大类别，例如声音audio、图象image等，后面定义具体的种类。</p>
<p>　　常见的MIME类型</p>
<p>　　超文本标记语言文本 .html,.html text/html</p>
<p>　　普通文本 .txt text/plain</p>
<p>　　RTF文本 .rtf application/rtf</p>
<p>　　GIF图形 .gif image/gif</p>
<p>　　JPEG图形 .jpeg,.jpg image/jpeg</p>
<p>　　au声音文件 .au audio/basic</p>
<p>　　MIDI音乐文件 mid,.midi audio/midi,audio/x-midi</p>
<p>　　RealAudio音乐文件 .ra, .ram audio/x-pn-realaudio</p>
<p>　　MPEG文件 .mpg,.mpeg video/mpeg</p>
<p>　　AVI文件 .avi video/x-msvideo</p>
<p>　　GZIP文件 .gz application/x-gzip</p>
<p>　　TAR文件 .tar application/x-tar</p>
<p>由于MIME类型与文档的后缀相关，因此服务器使用文档的后缀来区分不同文件的MIME类型，服务器中必须定义文档后缀和MIME类型之间的对应关系。而客户程序从服务器上接收数据的时候，它只是从服务器接受数据流，并不了解文档的名字，因此服务器必须使用附加信息来告诉客户程序数据的MIME类型。服务器在发送真正的数据之前，就要先发送标志数据的MIME类型的信息，这个信息使用Content-type关键字进行定义。</p>
</li>
<li><h5 id="phtml"><a href="#phtml" class="headerlink" title="phtml"></a>phtml</h5><p>其实我现在也没怎么懂。可能php里面是纯的php代码，而phtml中是js代码，不过通过修改language可以达到php的效果。</p>
<p>两者在服务器上的效果是一样的。</p>
</li>
<li><h5 id="一句话木马的执行原理"><a href="#一句话木马的执行原理" class="headerlink" title="一句话木马的执行原理"></a>一句话木马的执行原理</h5><p>eval函数中的字符串会被当做PHP语句来执行，其中用post的方式提交了一个变量，因此这个变量的具体值是我们可以控制的，而菜刀、蚁剑此类工具就是利用这个变量传入其他语句，本质上是一种小马传大马的方式。</p>
</li>
</ol>
</li>
</ul>
]]></content>
  </entry>
  <entry>
    <title>web-4 buuoj [极客大挑战 2019]BabySQL</title>
    <url>/2020/12/15/web-4/</url>
    <content><![CDATA[<h1 id="buuoj-极客大挑战-2019-BabySQL"><a href="#buuoj-极客大挑战-2019-BabySQL" class="headerlink" title="buuoj [极客大挑战 2019]BabySQL"></a>buuoj [极客大挑战 2019]BabySQL</h1><blockquote>
<ul>
<li><h4 id="解题思路"><a href="#解题思路" class="headerlink" title="解题思路"></a>解题思路</h4></li>
<li><h4 id="解题过程"><a href="#解题过程" class="headerlink" title="解题过程"></a>解题过程</h4></li>
<li><h4 id="get的新姿势"><a href="#get的新姿势" class="headerlink" title="get的新姿势"></a>get的新姿势</h4></li>
</ul>
</blockquote>
<a id="more"></a>

<ul>
<li><h3 id="解题思路-1"><a href="#解题思路-1" class="headerlink" title="解题思路"></a>解题思路</h3><ol>
<li>两个输入框，用户名试一下admin，密码随便试试。（后来看wp才知道，ctf比赛不是搞渗透测试，用户名尽量别用admin）</li>
<li>密码错误，对password试试注入。</li>
<li>根据回显判断应该用union联合注入，然而报错信息中没有显示各种关键词。</li>
<li>推断应该是对关键字进行了替换，尝试双写注入，最后成功绕过，得到flag。</li>
</ol>
</li>
<li><h3 id="解题过程-1"><a href="#解题过程-1" class="headerlink" title="解题过程"></a>解题过程</h3><ol>
<li><p>随便试试</p>
<p><img src="https://github.com/moonflowersl/moonflowersl.github.io/blob/main/images/web-4.1.png?raw=true"></p>
<p><img src="https://github.com/moonflowersl/moonflowersl.github.io/blob/main/images/web-4.2.png?raw=true"></p>
<p>有回显，试试union联合注入。</p>
</li>
<li><p>然而发现有神奇的错误回显</p>
<p><img src="https://github.com/moonflowersl/moonflowersl.github.io/blob/main/images/web-4.3.png?raw=true"></p>
<p>错误信息没有显示union和select？难道是过滤了？试试先。</p>
</li>
<li><p>看来是用了replace函数对关键字进行了替换，那可以试一下双写注入过滤。</p>
<p><img src="https://github.com/moonflowersl/moonflowersl.github.io/blob/main/images/web-4.4.png?raw=true"></p>
</li>
<li><p>似乎可以，继续查询表信息</p>
<p><img src="https://github.com/moonflowersl/moonflowersl.github.io/blob/main/images/web-4.5.png?raw=true"></p>
</li>
<li><p>然后好像还有过滤，都是报错信息中没有显示，继续尝试双写注入</p>
<p><img src="https://github.com/moonflowersl/moonflowersl.github.io/blob/main/images/web-4.6.png?raw=true"></p>
<p><img src="https://github.com/moonflowersl/moonflowersl.github.io/blob/main/images/web-4.7.png?raw=true"></p>
</li>
<li><p>双写information没用？？？想起来information好像也不是什么关键字，猜测可能是过滤了or</p>
<p><img src="https://github.com/moonflowersl/moonflowersl.github.io/blob/main/images/web-4.8.png?raw=true"></p>
<p>在or前加的注释语句，然而报错只回显了mation……把or给忽略了，看来是直接过滤了or</p>
<p><img src="https://github.com/moonflowersl/moonflowersl.github.io/blob/main/images/web-4.9.png?raw=true"></p>
<p>or绕过了，where好像也有过滤</p>
<p><img src="https://github.com/moonflowersl/moonflowersl.github.io/blob/main/images/web-4.10.png?raw=true"></p>
</li>
<li><p>查询成功，然后再爆列名和字段名</p>
<p><img src="https://github.com/moonflowersl/moonflowersl.github.io/blob/main/images/web-4.11.png?raw=true"></p>
<p><img src="https://github.com/moonflowersl/moonflowersl.github.io/blob/main/images/web-4.12.png?raw=true"></p>
<p>成功获得flag。</p>
</li>
</ol>
</li>
</ul>
<ul>
<li><h3 id="get的新姿势-1"><a href="#get的新姿势-1" class="headerlink" title="get的新姿势"></a>get的新姿势</h3><p>关于sql中的关键字绕过：</p>
<h4 id="绕过union，select，where等："><a href="#绕过union，select，where等：" class="headerlink" title="绕过union，select，where等："></a>绕过union，select，where等：</h4><h5 id="（1）使用注释符绕过："><a href="#（1）使用注释符绕过：" class="headerlink" title="（1）使用注释符绕过："></a>（1）使用注释符绕过：</h5><p>　　常用注释符：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;&#x2F;，-- , &#x2F;**&#x2F;, #, --+, -- -, ;,%00,--a</span><br></pre></td></tr></table></figure>

<p>　　用法：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">U&#x2F;**&#x2F; NION &#x2F;**&#x2F; SE&#x2F;**&#x2F; LECT &#x2F;**&#x2F;user，pwd from user</span><br></pre></td></tr></table></figure>

<h5 id="（2）使用大小写绕过："><a href="#（2）使用大小写绕过：" class="headerlink" title="（2）使用大小写绕过："></a>（2）使用大小写绕过：</h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">id&#x3D;-1&#39;UnIoN&#x2F;**&#x2F;SeLeCT</span><br></pre></td></tr></table></figure>

<h5 id="（3）内联注释绕过："><a href="#（3）内联注释绕过：" class="headerlink" title="（3）内联注释绕过："></a>（3）内联注释绕过：</h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">id&#x3D;-1&#39;&#x2F;*!UnIoN*&#x2F; SeLeCT 1,2,concat(&#x2F;*!table_name*&#x2F;) FrOM &#x2F;*information_schema*&#x2F;.tables &#x2F;*!WHERE *&#x2F;&#x2F;*!TaBlE_ScHeMa*&#x2F; like database()#</span><br></pre></td></tr></table></figure>

<h5 id="（4）-双关键字绕过（若删除掉第一个匹配的union就能绕过）："><a href="#（4）-双关键字绕过（若删除掉第一个匹配的union就能绕过）：" class="headerlink" title="（4） 双关键字绕过（若删除掉第一个匹配的union就能绕过）："></a>（4） 双关键字绕过（若删除掉第一个匹配的union就能绕过）：</h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">id&#x3D;-1&#39;UNIunionONSeLselectECT1,2,3–-</span><br></pre></td></tr></table></figure>

<h5 id="通用绕过（编码）："><a href="#通用绕过（编码）：" class="headerlink" title="通用绕过（编码）："></a>通用绕过（编码）：</h5><p>　　如URLEncode编码，ASCII,HEX,unicode编码绕过：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">or 1&#x3D;1即%6f%72%20%31%3d%31，而Test也可以为CHAR(101)+CHAR(97)+CHAR(115)+CHAR(116)。</span><br></pre></td></tr></table></figure>

</li>
</ul>
]]></content>
  </entry>
  <entry>
    <title>buuoj[ZJCTF 2019]NiZhuanSiWei</title>
    <url>/2020/12/22/web-5/</url>
    <content><![CDATA[<h2 id="buuoj-ZJCTF-2019-NiZhuanSiWei"><a href="#buuoj-ZJCTF-2019-NiZhuanSiWei" class="headerlink" title="buuoj[ZJCTF 2019]NiZhuanSiWei"></a>buuoj[ZJCTF 2019]NiZhuanSiWei</h2><blockquote>
<ul>
<li><h4 id="解题思路"><a href="#解题思路" class="headerlink" title="解题思路"></a>解题思路</h4></li>
<li><h4 id="解题过程"><a href="#解题过程" class="headerlink" title="解题过程"></a>解题过程</h4></li>
<li><h4 id="get的新姿势"><a href="#get的新姿势" class="headerlink" title="get的新姿势"></a>get的新姿势</h4></li>
</ul>
</blockquote>
<a id="more"></a>

<ul>
<li><h3 id="解题思路-1"><a href="#解题思路-1" class="headerlink" title="解题思路"></a>解题思路</h3><ol>
<li><p>get方式提交三个参数，然后通过一系列操作查看flag。</p>
</li>
<li><p>首先提交一个指定内容的text文件。</p>
</li>
<li><p>因为有flag关键词的过滤，所以不能直接查看，根据提示先查看一下useless.php。</p>
</li>
<li><p>运用反序列化的漏洞查看flag。</p>
<p>（然而我第二步就不知道怎么做了，看了wp才记起还有php伪协议这好东西……）</p>
</li>
</ol>
</li>
<li><h3 id="解题过程-1"><a href="#解题过程-1" class="headerlink" title="解题过程"></a>解题过程</h3><p>1.get方式提交text，if语句中用了file_get_contents()函数，意味着text需要是个文件，于是就可以使用data协议传入。</p>
<p>data协议读入文件的格式：data://text/plain,文件内容</p>
<p><img src="https://github.com/moonflowersl/moonflowersl.github.io/blob/main/images/web-5.1.png?raw=true"></p>
<p>2.第一层if绕过了，现在要想办法通过传file查看一下useless.php文件，这里同样用php伪协议对文件直接进行读取。</p>
<p>格式:php://filter/read/convert.base64-encode/resource=文件名</p>
<p><img src="https://github.com/moonflowersl/moonflowersl.github.io/blob/main/images/web-5.2.png?raw=true"></p>
<p>因为要是base64的方式查看，所以得到的东西要用base64解码一下</p>
<p><img src="https://github.com/moonflowersl/moonflowersl.github.io/blob/main/images/web-5.6.png?raw=true"></p>
<p>3.然后是经典php反序列化的问题了，用在线php写一个就完了</p>
<p><img src="https://github.com/moonflowersl/moonflowersl.github.io/blob/main/images/web-5.3.png?raw=true"></p>
<p>然后提交</p>
<p><img src="https://github.com/moonflowersl/moonflowersl.github.io/blob/main/images/web-5.4.png?raw=true"></p>
<p>这里的useless不需要查看了，所以也不需要php伪协议了。</p>
<p>4.得到flag</p>
<p><img src="https://github.com/moonflowersl/moonflowersl.github.io/blob/main/images/web-5.5.png?raw=true"></p>
</li>
<li><h3 id="get的新姿势-1"><a href="#get的新姿势-1" class="headerlink" title="get的新姿势"></a>get的新姿势</h3><ol>
<li><p>file:// 用于访问本地文件系统，在CTF中通常用来读取本地文件的且不受allow_url_fopen与allow_url_include的影响</p>
<p>Example：<u>?file=file://D:/soft/phpStudy/WWW/phpcode.txt</u></p>
</li>
<li><p>php:// 访问各个输入/输出流（I/O streams），在CTF中经常使用的是php://filter和php://input，php://filter用于读取源码，php://input用于执行php代码。</p>
<p>Example：<u>?file=php://filter/read=convert.base64-encode/resource=./cmd.php</u></p>
<p>​                   <u>?file=php://input &lt;?php phpinfo()?&gt;</u></p>
</li>
<li><p>zip://, bzip2://, zlib:// 均属于压缩流，可以访问压缩文件中的子文件，更重要的是不需要指定后缀名。</p>
<p>Example：<u>?file=zip://D:/soft/phpStudy/WWW/file.jpg%23phpcode.txt</u></p>
</li>
<li><p>自PHP&gt;=5.2.0起，可以使用data://数据流封装器，以传递相应格式的数据。通常可以用来执行PHP代码。</p>
<p>Example：<u>?file=data://text/plain,&lt;?php phpinfo()?&gt;</u></p>
</li>
</ol>
</li>
</ul>
]]></content>
  </entry>
  <entry>
    <title>sqli-labs5 盲注入门</title>
    <url>/2020/12/24/sqli5/</url>
    <content><![CDATA[<h1 id="sqli-labs5-盲注入门"><a href="#sqli-labs5-盲注入门" class="headerlink" title="sqli-labs5 盲注入门"></a>sqli-labs5 盲注入门</h1><blockquote>
<ul>
<li><h4 id="布尔型注入"><a href="#布尔型注入" class="headerlink" title="布尔型注入"></a>布尔型注入</h4></li>
<li><h4 id="时间延迟型注入"><a href="#时间延迟型注入" class="headerlink" title="时间延迟型注入"></a>时间延迟型注入</h4></li>
</ul>
</blockquote>
<a id="more"></a>

<ul>
<li><h3 id="布尔型注入-1"><a href="#布尔型注入-1" class="headerlink" title="布尔型注入"></a>布尔型注入</h3><ol>
<li><p>象征性检查一下注入方式（题目写的比较明白了）</p>
<p><img src="https://github.com/moonflowersl/moonflowersl.github.io/blob/main/images/sqli5.1.png?raw=true"></p>
</li>
<li><p>检查列数</p>
<p><img src="https://github.com/moonflowersl/moonflowersl.github.io/blob/main/images/sqli5.2.png?raw=true"></p>
</li>
<li><p>通过left函数截取database的前半段字符并进行判断（此处也可以用substr函数直接截取其中的任意一段）</p>
<p><img src="https://github.com/moonflowersl/moonflowersl.github.io/blob/main/images/sqli5.3.png?raw=true"></p>
</li>
<li><p>当然不可能自己挨个试了，我知道的方法有三种：</p>
<ul>
<li>手工二分法判断</li>
<li>扔burpsuite直接爆破</li>
<li>大佬们通常都写py脚本来跑</li>
</ul>
<p>这里我用的burpsuite来爆的</p>
<p><img src="https://github.com/moonflowersl/moonflowersl.github.io/blob/main/images/sqli5.4.png?raw=true"></p>
<p>这样就得知database名第一个字母是‘s’，然后通过调整left的参数和字段名最后爆出database名。</p>
</li>
<li><p>然后接着爆库名表名。。。就完了。</p>
<p><img src="https://github.com/moonflowersl/moonflowersl.github.io/blob/main/images/sqli5.5.png?raw=true"></p>
<p><img src="https://github.com/moonflowersl/moonflowersl.github.io/blob/main/images/sqli5.6.png?raw=true"></p>
</li>
</ol>
</li>
</ul>
<ul>
<li><h3 id="时间延迟型注入-1"><a href="#时间延迟型注入-1" class="headerlink" title="时间延迟型注入"></a>时间延迟型注入</h3><p>……好麻烦不想写了……</p>
<p>（算了简单写写思路吧）</p>
<p>时间延迟型注入主要应用了<strong>if()**和</strong>sleep()**函数。</p>
<p>*if(条件语句,a,b)*：执行条件语句，如果结果为真则返回a，若为假则返回为b。</p>
<p>*sleep(a)*：让浏览器歇a秒后再返回。</p>
<p>把两者一结合我们就可以构造这样的语句了：</p>
<p>?id=1’ and if(left((select database()),1),sleep(3),1)=’s’ –+</p>
<p>在这个例子中，如果database名的第一个字母是s，浏览器就会先加载3s再返回，否则会直接显示。</p>
</li>
</ul>
]]></content>
  </entry>
  <entry>
    <title>新生赛web3-混元形意</title>
    <url>/2020/12/24/web-6/</url>
    <content><![CDATA[<h1 id="新生赛web3-混元形意"><a href="#新生赛web3-混元形意" class="headerlink" title="新生赛web3-混元形意"></a>新生赛web3-混元形意</h1><blockquote>
<ul>
<li><h4 id="解题思路"><a href="#解题思路" class="headerlink" title="解题思路"></a>解题思路</h4></li>
<li><h4 id="解题过程"><a href="#解题过程" class="headerlink" title="解题过程"></a>解题过程</h4></li>
<li><h4 id="实名吐槽"><a href="#实名吐槽" class="headerlink" title="实名吐槽"></a>实名吐槽</h4></li>
</ul>
</blockquote>
<ul>
<li><h3 id="解题思路-1"><a href="#解题思路-1" class="headerlink" title="解题思路"></a>解题思路</h3></li>
</ul>
<ol>
<li>PHP代码审计，发现有反序列化函数，尝试构造字符串利用反序列化漏洞。</li>
<li>对get提交的参数存在过滤，尝试绕过。</li>
<li>通过unset和extract函数实现变量覆盖，绕过过滤。</li>
</ol>
<ul>
<li><h3 id="解题过程-1"><a href="#解题过程-1" class="headerlink" title="解题过程"></a>解题过程</h3></li>
</ul>
<ol>
<li>首先往下找找，发现unserialize函数，可以通过构造特殊的字符串来执行特定的命令。</li>
</ol>
<p><img src=""></p>
]]></content>
  </entry>
</search>
